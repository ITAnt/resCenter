real()  % 实部

imag()  % 虚部

angle()     % 相位

heaviside() %阶跃函数

fliplr()    % 翻转
rectpuls()  % 矩阵波
tripuls()   % 三角波

% 信号的奇偶分解
f = sym('cos(t+1)+t');
f1 = subs(f,t,-t);
g = 1/2 *(f+f1);    % 偶分量
h = 1/2 *(f-f1);    % 奇分量

信号的积分和微分
    连续信号
        diff(function,'variable',n)     % 微分
            function：信号
            variable：独立变量
            n：求导的阶数

        int(function,'variable',a,b)      % 积分
            a: 积分上限
            b：积分下限

卷积
    conv()
    conv2()
    convn()


simplify和simple是Matlab符号bai数学工具箱提供的两个简化函数，区别du如下：
    simplify的调用格式zhi为：simplify(S)；对表达式S进行化dao简。
    simple是通过对表达式尝试多种不同的方法（包括simplify）进行化简，以寻求符号表达式S的最简形式。

    simple 调用方式：
        [r,how] = simple(S);r为返回的简化形式，how为化简过程中使用的一种方法。how有以下几种形式：
            1. simplify 函数对表达式进行化简；
            2. radsimp函数对含根式的表达式进行化简；
            3. combine 函数将表达式中以求和、乘积、幂运算等形式出现的项进行合并；
            4. collet合并同类项
            5. factor函数实现因式分解
            6. convert函数完成表达式形式的转换

fftshift
    将零频率的分量移到频谱的中心
    对于向量，fftshift(X)将X均分为左右两部分并兑换。对于矩阵，fftshift(X)将第一个四分块同第三个四分块调换，第二个同第四个调换。
    对于更高维的数组，fftshift(X)沿着X的每一个维度，将X的两个“半空间”对调。
    Y=fftshift(X,dim)是对X的dim维度进行fftshift操作。
    注意：ifftshift是fftshift的逆过程。如果矩阵X包含奇数个元素，为了得到原始的X，我们必须用ifftshift(fftshift(X))这个操作。单纯的通过两次使用fftshift(X)将不会得到X。

cylinder函数：绘制三维圆柱图
    用法说明：
        1. [x,y,z]=cylinder 函数返回一半径和高度都为1的圆柱体x，y，z轴的坐标值，圆柱体沿其周长有20个等距分布的点
        2. [x,y,z]=cylinder(r) 函数一个半径为r、高度为1的圆柱体的x，y，z轴的坐标值，圆柱体沿其周长有20个等距分布的点
        3. [x,y,z]=cylinder(r,n) 函数一个半径为r、高度为1的圆柱体的x，y，z轴的坐标值，圆柱体沿其周长有n个等距分布的点
        4. cylinder(...) 函数只绘制圆柱，没有任何的输出参量。其他参量及结果同上

conj函数：用于计算复数的共轭值
    用法说明：y=conj(x)函数计算复数x的共轭值。输出结果y的维数跟输入x的维数一致，返回值为：real(y)-i*imag(y)

信号波的产生

    线性调频扫频信号函数
        chirp(t,f0,t1,f1,'method',phi,'shape')
            产生一个线性（频率随时间线性变化）信号，其时间轴设置由数组 t 定义。时刻 0 的瞬间频率为f0,时刻t1的瞬间频率为f1。默认情况，f0=0Hz,t1 =1,f1 = 100Hz
            method：
                指定改变扫频的方法。默认时为 linear
                linear 线性扫频
                quadratic：二次扫频
                logarithmic：对数扫频 ，必须有 f1>f0
            phi:
                指定信号的初始相位为 phi(单位为度)，默认时 phi =0。
            shape:
                指定二次扫频方法的抛物线的形状是凹还是凸，值为 concave 或 convex。
    
    方波信号产生
        square 函数可以得到方波函数。
            square(t,duty)：产生一个 2*pi 为周期的方波，范围为 -1 到 1 之间，占空比为50%。很像sin函数，比如sin函数输入pi/6 就是1/2，输入pi/2 就是1，输入pi就是0，输入3/2*pi就是-1；而square也是一样，输入的数小于pi，就是1，大于pi小于2*pi就是-1。
                duty：duty是一个百分数,duty = 75(75%的占空比），用于指定脉冲宽度与整个周期的比例。

随机函数与三角波函数
    rand(m,n)：返回一个 m X n 的随机矩阵。

    sawtooth()：用于产生锯齿波或三角波信号
        sawtooth(t)：产生周期为 2pi，振幅为 -1 到 1 的锯齿波。在 2pi 的整数倍处值为 -1 到1，这一段波形斜率为 1/pi。
        sawtooth(t,width)：产生三角波，width 在 0到1之间。


rectpuls 函数与 diric 函数

    rectpuls()：产生非周期方波信号函数
        rectpuls(t,w)：产生指定宽度为 w 的非周期方波
    
    diric()：用于产生 Dirichlet 函数或周期 Sinc 函数
        diric(x,n)：返回一大小与 x 相同的矩阵，其元素为 Dirichlet 函数
    
sinc 函数与 tripuls 函数
    sinc(x)：返回一个有 sinc 函数值为元素的矩阵。
    
    tripuls()：用于产生非周期三角波信号
        tripuls(t,w,s)：产生周期为 w 的非周期方波，斜率为 s（-1<s<1）

gauspuls 函数与 pulstran 函数
    guaspuls()：用于产生高斯正弦脉冲信号函数
        guaspuls(T,FC,BW,BWR):产生幅度为1 的高斯正弦脉冲（RF）信号的抽样
            T ：持续时间
            FC: 中心频率
            BW: 宽带
        
        TC = guaspuls('cutoff',FC,BE,BER,TPB):返回按参数 TEP(dB) 计算所对应的截断时间TC
    
    pulstran() 用于脉冲序列发生器
        pulstran(t,d,'func'):该函数基于一个名为 func 的连续函数并以之为一个周期，从而产生一串周期性的连续函数(func 函数可自定义)。pulstran 函数的横坐标范围有向量 t 指定，而向量 d 用于指定周期性的偏移量（即各个周期的中心点），这样这个 func 函数会被计算 length(d) 次，从而产生一个周期性脉冲信号。
        pulstran 函数的一个调用形式为 y = pulstran(t,d,'func',p1,p2,...)：p1,p2,... 为需要传送给 func 函数的额外输入参数值（除了变量t 之外）。

    

连续时间系统的时域分析

    连续时间系统的零状态与零输入响应的求解分析

        连续时间系统可以用常系数微分方程来描述，其完全响应由零输入响应和零状态响应组成。MATLAB 符号工具箱提供了 dsolve 函数，可以实现对常系数微分方程的符号求解，其调用格式为:
            dsolve('eq1,eq2,...','cond1,cond2,...','v')
                eq：表示各个微分方程
                cond：表示初始条件或者起始条件
                v: 表示自变量，默认是变量 t
            通过使用 dsolve 函数可以求出系统微分方程的零输入响应和零状态响应，进而求出完全响应。
    
    
    连续时间系统数值求解
        用于求解零初始条件微分方程数值解的函数 lsim，输入信号为 f
            lsim(sys,f,t);
                t：表示计算系统响应的抽样点向量
                f：系统输入信号向量
                sys：是 LTI 系统模型，用来表示微分方程、差分方程或状态方程。
                    sys = tf(b,a);
                        b 和 a 分别是微分方程的右端和左端系数向量。
        
    连续时间系统冲激响应和阶跃响应分析
        求解冲激响应可用 impulse 
            调用形式：
                impulse(sys,t);
        求解阶跃响应可用 step
            调用形式
                step(sys,t);
    
    连续时间系统卷积求解
        f = conv(f1,f2)*dt;
            
描述一个线性时不变离散时间系统，有如下两种常用方法：
    1. 用单位冲激响应来表征系统
    2. 用差分方程来描述系统输入与输出之间的关系。


离散时间系统响应
    函数 filter 可以用来对差分方程在指定时间范围内的输入序列所产生的响应进行求解，该函数的调用方法如下
        y = filter(b,a,x);
        [Y,Zf] = filter(b,a,x,zi)
        filter(b,a,x,[],dim)
            b：差分方程右端
            a：差分方程左端
            x：输入的离散序列
            zi: 指定X的初始状态，Zf为最终状态矢量
            dim: 指定的 x 的维数 DIM 进行操作
            y：输出的离散序列
    
    函数 impz() 函数用于求解离散时间系统单位冲激响应。
        调用形式：h = impz(b,a,k);
            a、b: 差分方程左、右端的系数向量
            k：表示输出序列的取值范围(可省略)
            h: 系统单位冲激响应（如果没有输出参数，直接调用 impz(b,a,k)，则 MATLAB将会在当前绘图窗口中自动画出系统单位冲激响应的图形）
    
    离散时间信号的卷积和运算
        conv() 函数用于计算两个离散序列卷积和的函数，其调用形式为
            c = conv(a,b)
            a、b 分别为待卷积的两序列的向量表示，c 是卷积结果。


变换
    Z变换的函数 ztrans() 和 Z 反变换的函数 iztrans()，其调用形式为
        F = ztrans(f);
        f = iztrans(F);
            右端的 f和 F分别为时域表示式和 Z域表示的符号表示，可应用函数 sym 来实现，其调用形式为：
                S = sym(A)
        
    留数法求 Z 反变换可以使用函数 residuez() 实现，调用格式为
        [R P K] = residuez(B,A);

        B和A 分别为X(z) 的多项式中分子多项式和分母多项式的系数向量
        返回值：
            R ：留数向量
            P ：极点向量
            K ：直接项系数，仅在分子多项式最高次幂大于等于分母多项式最高次幂时存在，否则，返回值为空。

离散系统函数频域分析
    利用MATLAB 来求解频率响应的过程如下：
        1. 根据系统函数 H(z)定义分子、分母多项式系数向量B 和 A
        2. 调用前述的 ljdt() 函数求出 H(z) 的零极点，并绘出零极点图
        3. 定义 z 平面单位圆上的 k 个频率分点
        4. 求出 H(z) 所有的零点和极点到这些等分点的距离
        5. 求出 H(z) 所有的零点和极点到这些等分点矢量的相角
        6. 求出系统的｜H(e^jw)｜ 和 相位
        7. 绘制指定范围内系统的幅频曲线和相频曲线

        在 MATLAB 中，函数 freqz 用于求离散时间系统频响特性，该函数的调用方法如下：
            [H,W] = freqz(B,A,N);
            [H,W] = freqz(B,A,N,'whole')

            B 与 A 分别表示 H(z)的分子与分母多项式的系数向量
            N 为正整数，默认值为 512
            W 包含 [0,pi] 范围内的N个频率等分点
            H 离散时间系统频率响应 H(e^jw) 在 0～pi 范围内N的频率处对应的值
        
    
离散系统函数零点分析
    在MATLAB 中，系统函数的零极点就可以通过函数 roots 得到，也可以借助函数 tf2zp 得到
        roots(A)：求系统的极点
        roots(B)：求系统的零点

        [Z,P,K] = tf2zp(B,A)： 将 H(z) 的有理式表示为转换为零极点增益形式。 
            B 与 A 分别表示为 H(z) 的分子与分母多项式的系数向量

        zplane() 函数用于绘制 H(z) 的零极点图，调用格式为
            zplane(z,p)
            绘制出列向量 z 中的零点（以符号"o"表示）和列向量 p 中的极点(以符号"X"表示)，以及参考单位圆，在多阶零点和极点的右上角标出其阶数。如果z 和p 为矩阵，则会以不同颜色绘出 z 和 p 各列中的零点和极点。

离散系统差分函数求解
    差分方程的解也分为通解与特解，通解是与方程初始状态有关的解，特解与外部输入有关，它描述系统在外部输入作用下的强迫运动。

    filtic(): 为滤波器的直接实现选择初始条件

    https://blog.csdn.net/wangming520liwei/article/details/29816075

离散的傅立叶变换
    在实际数据处理中，k 一般取 N/2，此时波的周期最小，获得的频率范围最大，所以想要获得高频率的信号，就需要缩短取样间隔。

    dftmtx(n) 返回 nxn 的复杂离散傅立叶变换矩阵。
        x = rand(1,Nfft);
        y = dftmtx(Nfft)*x  和 y = fft(x) 是等价的
    
    示例
        xn = sin(100*2*pi*t);
        N = length(xn);
        WNnk = dftmtx(N);
        Xk = xn * WNnk;
        y = fft(xn);

    频率域采样
        频率响应的混叠失真
            N  = fs/f0 >(2fh)/f0,这是实现DFT 算法必须满足的最低条件。如果不满足该条件，则会产生频域响应的周期延拓分量重叠现象，即频率响应的混叠失真。
        
        频谱泄露
            实际情况下，我们取的信号都是有限长的，即对原始序列做加窗处理使其成为有限长，时域的乘积对应频域的卷积，造成频谱的泄漏。
            减小泄漏的方法：可以取更长的数据（与原始数据就越相近），缺点运算量加大；可以选择窗的形状，从而使窗谱的旁瓣能量更小。
        
        栅栏效应
            DFT 上看到的谱线都是离散的，而从序列的傅立叶变换知道谱线是连续的，所以相当于看到谱的一些离散点，而不是全部，感觉像是透过栅栏看到的情景，称为栅栏效应。
        
        频率分辨率
            增加分辨率只有通过加大取样点 N，但不是补零的方式来增加 N,因为补零不是原始信号的有效信号。

快速傅立叶变换
    快速傅立叶变换是傅立叶变换的一种快速算法，简称为 fft,采用这种算法能大大减少计算离散傅立叶变换所需要的乘法次数，特别是被变换的抽样点数 N 越多，FFT 算法计算量的节省就越显著。
    根据对称性和周期性，可分为两类
        时间抽取法
        频率抽取法
    
    基于2时分的FFT算法

    基于2频分的FFT算法

    快速傅立叶变换的MATLAB实现

        fft(x,n)
            x ：取样的样本，可以是一个向量，也可以是一个矩阵
            y : x 的快速傅立叶变换
            n : 通过改变 n 值来直接对样本进行补零或者截断的操作（n省略，实际操作中，会对 x 进行补零操作，使 x 的长度等于 2 的整数次幂，这样能提高程序的计算速度）
        y = ifft(X)：用来计算序列的逆傅立叶变换。
            x : 需要进行逆变换的信号
            y : 为快速傅立叶反变换的输出 


离散余弦变换
    在傅立叶级数展开式中，如果被展开的函数是实偶函数，那么其傅立叶级数中只包含余弦项，再将其离散化可导出余弦变换，因此称之为离散余弦变换。
    在 MATLAB 中，dct 函数用于进行 DCT 变换，该函数的调用方法如下：
        y = dct(x): 返回序列 x 的DCT 结果
    dict2 函数用于 DCT  反变换，该函数调用方法为
        B = dict2(A)：计算 A 的 DCT 反变换B，A与 B的大小相同
    

Chirp Z变换
    系统的单位冲激响应 h(n) = W^(-n^2/2)与频率随时间成线性增加的线性调频信号相似，因此称为 Chirp-Z 变换。
    在 MATLAB 中，czt 函数用于实现 Chirp-Z 变换，该函数的调用方式如下：
        y = czt(x,m,w,a);
        此函数计算由  z = a*w.^(-(0:m-1)) 定义的 z 平面螺旋线上各点的 Z 变换,a 规定了起点，w规定了相邻点的比例，m 规定了变换的长度，后 3 个变量默认值为 a=1,w = exp(j*2*pi/m) 及 m = length(x),因此 y =czt(x) 就等于 y =fft(x)
    
Gabor 函数
    Gabor 变换属于加窗傅立叶变换，Gabor 函数可以在频域不同尺度、不同方向上提取相关的特征。另外 Gabor 函数与人眼的生物作用相仿，所以经常用作纹理识别上，并取得了较好的效果。

    Gabor展开
        用过采样的 Gabor 展开来检测瞬时信号，效果要比传统的方法好。Gabor展开固有的局部化特性，使它特别适合于描述瞬时信号，可选择单边指数窗作为Gabor 展开的窗函数，与瞬时信号的非对称性及突变性相适应。
        利用 Gabor 展开，得到观测信号展开后的系统，就可以用其系数啦检测瞬时信号的存在。



经典傅立叶变换只能反映信号的整体特性（时域、频域）。对信号的齐性不敏感，不能给出在各个局部时间范围内部频谱上的谱信息描述。


滤波器
    数字滤波器的功能就是把输入序列 x(n) 通过一定的运算变换成输出序列 y(n) ,不同的运算处理方法决定了滤波器实现结构的不同
    FIR：有限脉冲响应滤波器
    IIR：无线脉冲响应滤波器
    
    滤波器也可以看成一个系统，如果用一个理想脉冲信号激励，就会有输出，我们把输出个数有限的称为有限脉冲响应滤波器（FIR）；输出无限多的称为无限脉冲响应滤波器（IIR）。

    IIR
        无限冲激响应滤波器的单位抽样响应 h(n) 是无限长的，对于一个给定的线性时不变系统的系统函数，有着各种不同的等效差分方程或网络结构。
        由于乘法是一种耗时运算，而每个延迟单元都要有一个存储寄存器。因此，采用最少常数乘法器和最少延迟支路的网络结构是通常的选择，以便提高运算速度和减少存储器。然而，当需要考虑有限寄存器长度的影响时，往往也并非采用最少乘法和延迟单元的结构。
        IIR滤波器实现的基本结构有直接型、级联型和并联型

        直接型（累加）
            直接 I 型的系统输入输出关系的 N 阶差分方程
                y(n) = sum(ak.*y(n-k)) ~(1->N) +sum(bk.*x(n-k)) ~(0->M)

                sum(bk.*x(n-k)) ~(0->M) 表示将输入及延时后的输入组成 M 节的延时网络，即横向延时网络，实现零点
                sum(ak.*y(n-k)) ~(1->N) 表示输出及其延时组成 N 节延时网络，实现极点
                直接 I 型需要 N+M 级延时单元
            
            如果相同输出的延迟单元合并成一个，N阶滤波器只需要 N级延迟单元，这是实现 N 阶滤波器所必须的最少数量的延迟单元。这种结构称为直接型II,有时将直接型I 简称为直接型，将直接型II称为典型形式。
            结构的特点如下：
                1. 只需 N 个延时单元
                2. 系数对滤波器的性能控制作用不明显
                3. 极点对系数变换过于灵敏
            通常在实际中很少采用上述两种结构实现高阶系统，而是把高阶变成一系列不同组合的低阶系统（一、二阶）来实现
            在 MATLAB 中，提供 filter 函数实现 IIR 的直接形式，其调用格式如下：
                y = filter(b,a,x);
                b : 表示系统传递函数的分子多项式的系数矩阵
                a : 表示系统传递函数的分母多项式的系数矩阵
                x : 表示输入序列
                y : 表示输出序列
        
        级联型（变换为数乘方式）
            实现方法
                1. 当 M=N 时，共有 (N+1)/2 （下取整） 节
                2. 如果有奇数个实零点，则有一个 B(下标为2k) 等于零。如果有奇数个实极点，则有一个 a(下标为2k)等于零
                3. 一阶、二阶基本节，整个滤波器级联
        
            特点：
                1. 系统实现简单，只需一个二阶节系统通过改变输入系数即可完成
                2. 极点位置可单独调整
                3. 运算速度快（可并行进行）
                4. 各二阶网络的误差互不影响，总的误差小，对字长要求低
            缺点：
                不能直接调整零点，因为多个二阶节的零点并不是整个系统函数的零点，当需要准确的传输零点时，级联型最合适

        并联型（因式分解）

            优点：
                1. 简化实现，用一个二阶节，通过变换系数就可实现整个系统
                2. 极、零点可单独控制、调整，调整 a(下标为2k),r(下标为2k) 只单独调整了第 i 对零点，调整 B(下标1i),B(下标2i)，则单独调整了第i对极点
                3. 各二阶节零、极店的搭配可互换位置，优化组合以减少运算误差
                4. 可流水线操作
            缺点：
                二阶节电平难控制，电平大易导致溢出，电平小则使信噪比减小
           